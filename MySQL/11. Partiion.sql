#CREATE A DATABASE
CREATE DATABASE INEURON_PARTITION;

USE INEURON_PARTITION;

DROP TABLE INEURON_COURSE

#CREATE A TABLE
CREATE TABLE INEURON_COURSE(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)

SELECT * FROM INEURON_COURSE;

#INSERT DATA INTO TABLE
INSERT INTO INEURON_COURSE VALUES(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019)

INSERT INTO INEURON_COURSE VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019)

SELECT * FROM INEURON_COURSE WHERE COURSE_LAUNCH_YEAR = 2020

#---------------------------------------------------------------------------------
#---PARTIION BY RANGE
#---------------------------------------------------------------------------------

CREATE TABLE INEURON_COURSE1(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)
PARTITION BY RANGE(COURSE_LAUNCH_YEAR)(
PARTITION P0 VALUES LESS THAN (2019),
PARTITION P1 VALUES LESS THAN (2020),
PARTITION P2 VALUES LESS THAN (2021),
PARTITION P3 VALUES LESS THAN (2022),
PARTITION P4 VALUES LESS THAN (2023));

SELECT * FROM INEURON_COURSE WHERE COURSE_LAUNCH_YEAR = 2020

INSERT INTO INEURON_COURSE1 VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019)

SELECT * FROM INEURON_COURSE1 WHERE COURSE_LAUNCH_YEAR = 2020

select partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE1'

select COURSE_lAUNCH_YEAR, count(COURSE_lAUNCH_YEAR) from INEURON_COURSE1 group by COURSE_lAUNCH_YEAR;

#---------------------------------------------------------------------------------
#---HASH PARTITIONING
#---------------------------------------------------------------------------------

CREATE TABLE INEURON_COURSE_HASH(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)
PARTITION BY HASH(COURSE_lAUNCH_YEAR)
PARTITIONS 10;

INSERT INTO INEURON_COURSE_HASH VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_HASH'

#DIFFERENT KIND OF HASH ALGORITHMS BY WHICH DATA GETS INSERTED INTO A TABLE, 
#ONE OF THE ALGORITHM IS REMAINDER ALGORITHM WHERE PARTIION WILL DIVIDE BASED ON PARTITION PARAMETER
#ACCORDINGLY IT WILL PUT DATA INTO RESPECTIVE PARTITIONS

#-------------------------------------------------------------------
#KEY PARTITION
#-------------------------------------------------------------------

CREATE TABLE INEURON_COURSE_KEY(
COURSE_ID INT PRIMARY KEY,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)
PARTITION BY key()
PARTITIONS 10;

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_KEY'

INSERT INTO INEURON_COURSE_KEY VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);

#MD5 HASHING ALGORITHM - WILL GENERATE A ALPHANUMERIC NUMBER. ACCORDINGLY IT WILL DIVIDE A DATA
SELECT MD5(1001)
SELECT MD5(1002)

#--------------------------------------------------------------------------
#--- LIST PARTITION
#--------------------------------------------------------------------------

CREATE TABLE INEURON_COURSE_LIST(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)
PARTITION BY LIST(COURSE_lAUNCH_YEAR)(
PARTITION P0 VALUES IN (2019,2020),
PARTITION P1 VALUES IN (2021),
PARTITION P2 VALUES IN (2022)
)

INSERT INTO INEURON_COURSE_LIST VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_LIST'

#--------------------------------------------------------
#--- RANGE COLUMNS
#--------------------------------------------------------

CREATE TABLE INEURON_COURSE_RANGE_COLUMNS(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_LAUNCH_YEAR int)
PARTITION BY RANGE COLUMNS(COURSE_ID, COURSE_NAME, COURSE_FEE)(
PARTITION P0 VALUES LESS THAN (1005,'AIOPS',3540),
PARTITION P1 VALUES LESS THAN (1010,'FSDA',3540),
PARTITION P2 VALUES LESS THAN (1015,'FSDS',3540)
)

INSERT ignore INTO INEURON_COURSE_RANGE_COLUMNS VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_RANGE_COLUMNS'

#--------------------------------------------------------
#--- LIST COLUMNS
#--------------------------------------------------------

CREATE TABLE INEURON_COURSE_LIST_COLUMNS(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_LAUNCH_YEAR int)
PARTITION BY LIST COLUMNS(COURSE_NAME)(
PARTITION P0 VALUES IN ('DL','AIOPS','MACHINE LEARNING'),
PARTITION P1 VALUES IN ('JAVA','DATA ANALYTICS','BIG DATA'),
PARTITION P2 VALUES IN ('FSDS','FSDA')
)

INSERT ignore INTO INEURON_COURSE_LIST_COLUMNS VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_LIST_COLUMNS'

#---------------------------------------------------------
#-- SUB PARTITIONING
#---------------------------------------------------------

DROP TABLE INEURON_COURSE_SUB_PARTITION

CREATE TABLE INEURON_COURSE_SUB_PARTITION(
COURSE_ID INT,
COURSE_NAME VARCHAR(40),
COURSE_TITLE VARCHAR(60),
COURSE_DESCR VARCHAR(60),
LAUNCH_DATE DATE,
COURSE_FEE INT,
COURSE_MENTOR VARCHAR(60),
COURSE_lAUNCH_YEAR YEAR)
PARTITION BY RANGE(COURSE_lAUNCH_YEAR)
SUBPARTITION BY HASH(COURSE_lAUNCH_YEAR)
SUBPARTITIONS 5 (
PARTITION P0 VALUES LESS THAN (2019),
PARTITION P1 VALUES LESS THAN (2020),
PARTITION P2 VALUES LESS THAN (2021),
PARTITION P3 VALUES LESS THAN (2022)
);

SELECT partition_name, table_name, table_rows from information_schema.partitions where table_name = 'INEURON_COURSE_SUB_PARTITION'

INSERT ignore INTO INEURON_COURSE_SUB_PARTITION VALUES
(1001,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1002,'AIOPS','ML','THIS IS AIOPS COURSE','2019-07-07',3540,'SUDHANSHU',2019),
(1003,'BIG DATA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1004,'DATA ANALYTICS','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1005,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1006,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1007,'JAVA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1008,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1009,'MACHINE LEARNING','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1010,'AIOPS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1011,'BIG DATA','ML','THIS IS ML COURSE','2022-07-07',3540,'SUDHANSHU',2022),
(1012,'FSDS','ML','THIS IS ML COURSE','2021-07-07',3540,'SUDHANSHU',2021),
(1013,'FSDA','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1014,'DL','ML','THIS IS ML COURSE','2020-07-07',3540,'SUDHANSHU',2020),
(1015,'MACHINE LEARNING','ML','THIS IS ML COURSE','2019-07-07',3540,'SUDHANSHU',2019);
